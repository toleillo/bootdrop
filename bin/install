#!/bin/bash

# Create link for a new settings.php
if [[ -e shared/settings.php ]]; then
  rm shared/settings.php
fi
cp shared/default.settings.php shared/settings.php
if [[ ! -e drupal/sites/default/settings.php ]]; then
  ln -s ../../../shared/settings.php drupal/sites/default/settings.php
fi

# Create an empty shared/files and link it
if [[ -e shared/files ]]; then
  rm -rf shared/files
fi
mkdir shared/files
chmod 777 shared/files
if [[ ! -e drupal/sites/default/files ]]; then
  ln -s ../../../shared/files drupal/sites/default/files
fi

# Install site with drush
cd drupal
drush site-install -y --account-name=admin --account-pass=password
cd -
